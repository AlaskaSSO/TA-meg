[mcafee:meg]
rename=meg

[meg]
KV_MODE = none
#If this is installed on your indexer or your heavy forwarder
#This will replace all instances of the string McafeeEmailgateway with MEG;
#The CEF format as done by Mcafee is space inefficient in storing data
#this is 100% optional, all REGEX's and extractions work with or without this done
#If it is done a average savings of 180 bytes per CEF log entry will occur... this savings adds up over time!
SEDCMD-meg-replace = s/\sMcafeeEmailgateway/\sMEG/g


REPORT-meg_applicationevent = meg_applicationevent
REPORT-meg_cef_log = meg_cef_log
REPORT-meg_cef_originalsubject = meg_cef_originalsubject
REPORT-meg_cef_act = meg_cef_act
REPORT-meg_cef_app = meg_cef_app
REPORT-meg_cef_cnt = meg_cef_cnt
REPORT-meg_cef_dvc = meg_cef_dvc
REPORT-meg_cef_msg = meg_cef_msg
REPORT-meg_cef_dvchost = meg_cef_dvchost
REPORT-meg_cef_dst = meg_cef_dst
REPORT-meg_cef_dhost = meg_cef_dhost
REPORT-meg_cef_dmac = meg_cef_dmac
REPORT-meg_cef_dntdom = meg_cef_dntdom
REPORT-meg_cef_dpt = meg_cef_dpt
REPORT-meg_cef_dproc = meg_cef_dproc
REPORT-meg_cef_dpriv = meg_cef_dpriv
REPORT-meg_cef_duser = meg_cef_duser
REPORT-meg_cef_fname = meg_cef_fname
REPORT-meg_cef_fsize = meg_cef_fsize
REPORT-meg_cef_in = meg_cef_in
REPORT-meg_cef_out = meg_cef_out
REPORT-meg_cef_proto = meg_cef_proto
REPORT-meg_cef_request = meg_cef_request
REPORT-meg_cef_src = meg_cef_src
REPORT-meg_cef_shost = meg_cef_shost
REPORT-meg_cef_sntdom = meg_cef_sntdom
REPORT-meg_cef_spt = meg_cef_spt
REPORT-meg_cef_spriv = meg_cef_spriv
REPORT-meg_cef_suid = meg_cef_suid
REPORT-meg_cef_suser = meg_cef_suser
REPORT-meg_cef_cat = meg_cef_cat
REPORT-meg_cef_cs1 = meg_cef_cs1
REPORT-meg_cef_cs2 = meg_cef_cs2
REPORT-meg_cef_cs4 = meg_cef_cs4
REPORT-meg_cef_cs5 = meg_cef_cs5
REPORT-meg_cef_cs6 = meg_cef_cs6
REPORT-meg_cef_cn1 = meg_cef_cn1
REPORT-meg_cef_cn2 = meg_cef_cn2
REPORT-meg_cef_cn3 = meg_cef_cn3
REPORT-meg_cef_devicedirection = meg_cef_devicedirection
REPORT-meg_cef_rt = meg_cef_rt
REPORT-meg_cef_sourceservicename = meg_cef_sourceservicename
REPORT-meg_cef_filepath = meg_cef_filepath
REPORT-meg_cef_fileid = meg_cef_fileid
REPORT-meg_cef_flexnumber1 = meg_cef_flexnumber1
REPORT-meg_cef_originalsender = meg_cef_originalsender
REPORT-meg_cef_originalmessageid = meg_cef_originalmessageid
REPORT-meg_cef_emailencryptiontype = meg_cef_emailencryptiontype
REPORT-meg_cef_emailhybridid = meg_cef_emailhybridid
REPORT-meg_cef_scanhostip = meg_cef_scanhostip
REPORT-meg_cef_hostname = meg_cef_hostname
REPORT-meg_cef_hostdomainname = meg_cef_hostdomainname
REPORT-meg_cef_macaddress = meg_cef_macaddress
REPORT-meg_cef_uuid = meg_cef_uuid
REPORT-meg_cef_username = meg_cef_username
REPORT-meg_periodic_statistics_log1 = meg_periodic_statistics_log1
REPORT-meg_periodic_statistics_log2 = meg_periodic_statistics_log2
REPORT-meg_periodic_statistics_log3 = meg_periodic_statistics_log3
REPORT-meg_periodic_statistics_log4 = meg_periodic_statistics_log4
REPORT-meg_periodic_statistics_log5 = meg_periodic_statistics_log5
REPORT-meg_periodic_statistics_log6 = meg_periodic_statistics_log6
REPORT-meg_application_status = meg_application_status
REPORT-meg_application_from = meg_application_from
REPORT-meg_application_value = meg_application_value
REPORT-meg_application_convid = meg_application_convid
REPORT-meg_splunk_srcip_1 = meg_splunk_srcip_1
REPORT-meg_splunk_srcip_2 = meg_splunk_srcip_2
REPORT-meg_splunk_destip = meg_splunk_destip
REPORT-meg_splunk_status = meg_splunk_status
REPORT-meg_splunk_action = meg_splunk_action
REPORT-meg_splunk_ts_lookup_hash = meg_splunk_ts_lookup_hash
REPORT-meg_splunk_file_size = meg_splunk_file_size
REPORT-meg_splunk_msgid = meg_splunk_msgid
REPORT-meg_splunk_msgid2 = meg_splunk_msgid2
REPORT-meg_splunk_orig_msgid = meg_splunk_orig_msgid
REPORT-meg_splunk_orig_recipient = meg_splunk_orig_recipient
REPORT-meg_splunk_orig_src = meg_splunk_orig_src
REPORT-meg_splunk_sender = meg_splunk_sender
REPORT-meg_splunk_protocol = meg_splunk_protocol
REPORT-meg_splunk_recipient = meg_splunk_recipient
REPORT-meg_splunk_recipient_count = meg_splunk_recipient_count
REPORT-meg_splunk_size = meg_splunk_size
REPORT-meg_splunk_scanner = meg_splunk_scanner
REPORT-meg_splunk_macaddress = meg_splunk_macaddress
REPORT-meg_splunk_subject = meg_splunk_subject
REPORT-meg_splunk_dest_host = meg_splunk_dest_host
REPORT-meg_splunk_attachments = meg_splunk_attachments
REPORT-meg_splunk_number_attachments = meg_splunk_number_attachments
REPORT-meg_splunk_event_id = meg_splunk_event_id
REPORT-meg_splunk_url = meg_splunk_url
REPORT-meg_splunk_encryption_type = meg_splunk_encryption_type
REPORT-meg_splunk_virus_name = meg_splunk_virus_name
REPORT-meg_splunk_contentrule = meg_splunk_contentrule
REPORT-meg_splunk_content_terms = meg_splunk_content_terms
REPORT-meg_splunk_dlpfile = meg_splunk_dlpfile
REPORT-meg_splunk_dlprules = meg_splunk_dlprules
REPORT-meg_splunk_dlpclassification = meg_splunk_dlpclassification
REPORT-meg_splunk_dlpfileuploaded = meg_splunk_dlpfileuploaded
REPORT-meg_splunk_dlpfiledigest = meg_splunk_dlpfiledigest
REPORT-meg_splunk_dlpfilesize = meg_splunk_dlpfilesize
REPORT-meg_splunk_dvc_host = meg_splunk_dvc_host
REPORT-meg_splunk_spamscore = meg_splunk_spamscore
REPORT-meg_splunk_spamthreshold = meg_splunk_spamthreshold
REPORT-meg_splunk_spamrules = meg_splunk_spamrules


#is-primary-action is field name in CEF, is_primary_action is field name in splunk log format
EVAL-is_primary_action = coalesce(is-primary-action,is_primary_action)
##master-scan-type is field name in CEF, scanner is field name in splunk log format
EVAL-scanner = coalesce(master-scan-type,scanner)
#meg_action is from CEF format, action is from splunk log format
EVAL-meg_action = coalesce(meg_action,action)
#meg_msg is from CEF format, status is from splunk log format
#sample value is Email Delivered
#EVAL-status = coalesce(meg_cef_msg,status)
#EVAL-message_info = coalesce(meg_cef_msg,status)
EVAL-sender = coalesce(meg_suser,meg_splunk_sender)
#EVAL-recipient = coalesce(meg_duser,recipient)
EVAL-orig_recipient = coalesce(orig_recipient,recipient)
#This is for the pwned command
EVAL-email = coalesce(recipient,orig_recipient)
EVAL-message_id = coalesce(meg_originalmessageid,msgid)
EVAL-internal_message_id = coalesce(internal_message_id,msgid)
#EVAL-orig_msgid = coalesce(meg_originalmessageid,orig_msgid)
EVAL-recipient_count = coalesce(number-email-recipients,meg_splunk_recipient_count)
EVAL-relay = coalesce(meg_dhost,relay)
EVAL-subject = coalesce(email-subject,meg_splunk_subject,subject)
EVAL-encryption_type = coalesce(meg_emailencryptiontype,encryption_type)
EVAL-orig_subject = coalesce(meg_originalsubject,orig_subject)
EVAL-orig_sender = coalesce(meg_originalsender,orig_sender)
EVAL-orig_src = coalesce(meg_originalsender,meg_splunk_orig_sender,orig_src,sender)
EVAL-file_size = coalesce(meg_fsize,file_size)
EVAL-attachments = coalesce(email-attachments,attachments,meg_splunk_attachments)
EVAL-number_attachments = coalesce(num-email-attachments,number_attachments,meg_splunk_number_attachments)
EVAL-virus_name = coalesce(virus_names,virus_name)
EVAL-file_name = coalesce(meg_fname,file_name,meg_splunk_attachments)
EVAL-src_user = coalesce(meg_suser,meg_splunk_sender)
EVAL-return_addr = coalesce(meg_suser,meg_splunk_sender)
EVAL-signature_id = coalesce(meg_splunk_event_id,meg_cef_event_id,event_id)
EVAL-signature_extra = coalesce(meg_cef_msg,signature_extra)
#CEF format does not include spam or URL that I am aware of
#EVAL-spamscore = coalesce(spamscore)
#EVAL-spamthreshold = coalesce(spamthreshold)
#EVAL-spamrules = coalesce(spamrules)
EVAL-URL = coalesce(meg_splunk_url)
EVAL-contentrule = coalesce(content-rules,contentrule)
EVAL-content_terms = coalesce(compliance-terms,content_terms)
# TODO: find tz from CEF format
#EVAL-tz = coalesce(tz)
# TODO: find tz_offset from CEF format
#EVAL-tz_offset = coalesce(tz_offset)
# TODO: find dlpfile in CEF format
#EVAL-dlpfile = coalesce(dlpfile)
# TODO: find dlprules in CEF format
#EVAL-dlprules = coalesce(dlprules)
# TODO: find dlpclassification in CEF format
#EVAL-dlpclassification = coalesce(dlpclassification)
# TODO: find dlpfileuploaded in CEF format
#EVAL-dlpfileuploaded = coalesce(dlpfileuploaded)
# TODO: file dlpfiledigest in CEF format
#EVAL-dlpfiledigest = coalesce(dlpfiledigest)
# TODO: file dlpfilesize in CEF format
#EVAL-dlpfilesize = coalesce(dlpfilesize)
# TODO find iascore in CEF format
#EVAL-iascore = coalesce(iascore)
# TODO: find iathreshold in CEF format
#EVAL-iathreshold = coalesce(iathreshold)
#TODO: find ts_reputation_score in CEF format
#EVAL-ts_reputation_score = coalesce(ts_reputation_score)
#TODO: find ts_geo_location in CEF format
#EVAL-ts_geo_location = coalesce(ts_geo_location)
#TODO: find ts_ip_rep_status = coalesce(ts_ip_rep_status)
#EVAL-ts_ip_rep_status = coalesce(ts_ip_rep_status)
#TODO: find ts_hash_length in CEF format
#EVAL-ts_hash_length = coalesce(ts_hash_length)
#TODO: find ts_lookup_hash in CEF format
#EVAL-ts_lookup_hash
#ignore utc-time
#EVAL-utc-time = coalesce(utc-time)
#ignore local-time
#EVAL-local-time = coalesce(local-time)
#ignore utc-time-txt
#EVAL-utc-time-txt = coalesce(utc-time-txt)
EVAL-scan-host-name = coalesce(meg_dvc,scan-host-name)
EVAL-scan-host-ip = coalesce(meg_scanhostip,scan-host-ip)
EVAL-host-name = coalesce(meg_hostname,host-name)
EVAL-host-domain-name = coalesce(meg_hostdomainname,host-domain-name)
EVAL-mac-address = coalesce(meg_macaddress,mac-address,mac_splunk_macaddress)
EVAL-dvc_mac = coalesce(meg_macaddress,mac-address,mac_splunk_macaddress)
EVAL-dvc = coalesce(meg_dvchost,meg_dvc,meg_splunk_dvc_host)
#product='EG (7.6) EG5500'
EVAL-product = coalesce(meg_product,product)
EVAL-user-name = coalesce(meg_username,user-name)
EVAL-src_ip = coalesce(src_ip,meg_src_ip_1,meg_src_ip_2)
EVAL-dest_ip = coalesce(dest_ip,meg_splunk_destip)
EVAL-dest = coalesce(meg_splunk_dest_host,meg_dhost,dest_host,dest_ip,meg_splunk_destip)
EVAL-dest_host = coalesce(meg_splunk_dest_host,meg_dhost,dest_host)
EVAL-src = coalesce(src_ip,meg_src_ip_1,meg_src_ip_2)






LOOKUP-vendor_info_for_meg = meg_vendor_info_lookup sourcetype OUTPUT vendor,product,vendor_product
LOOKUP-signature_for_meg = meg_signature_lookup signature_id OUTPUT signature
LOOKUP-action_for_meg = meg_action_lookup meg_action OUTPUT action
LOOKUP-category_for_meg = meg_category_lookup meg_category OUTPUT category

